class Brush{constructor(t,s,e,i){this.fullspeed=5,this.opacityLevel=30,this.radiusMin=.003*DOMINANTSIDE,this.radiusMax=.004*DOMINANTSIDE,this.brushShape="Triangle",this.distanceBoost=4,this.OkLevel=40,this.fillColor=color(red(e),green(e),blue(e),this.opacityLevel),this.strokeColor=color(red(e),green(e),blue(e),this.opacityLevel),this.strokeSize=.2,this.strokeColorDistort=10,this.start=t,this.end=s,this.category=i,this.alive=!0,this.passedA=!1,this.passedB=!1,this.pos=this.start.copy(),this.elementCount=5,this.elements=[],this.vel=createVector(0,0,0),this.acc=createVector(0,0,0),this.Distance=p5.Vector.sub(this.end,this.start),this.DistanceLength=this.Distance.mag(),this.distAccSlo=this.DistanceLength/this.distanceBoost,this.boost=this.fullspeed/this.distAccSlo,this.checkpointA=p5.Vector.add(this.start,p5.Vector.div(this.Distance,this.distanceBoost)),this.checkpointB=p5.Vector.sub(this.end,p5.Vector.div(this.Distance,this.distanceBoost)),this.accBoost=p5.Vector.mult(p5.Vector.normalize(this.Distance),this.boost),this.sloBoost=p5.Vector.mult(this.accBoost,-1),this.get_orientation(),this.anglePath=atan2(this.end.y-this.start.y,this.end.x-this.start.x),this.endOrtho=p5.Vector.add(this.end,p5.Vector.fromAngle(this.anglePath-PI/2,100))}get_orientation(){this.acceptanceLevel=PI/12,this.angle=p5.Vector.sub(this.end,this.start).heading(),this.angle>-this.acceptanceLevel&&this.angle<this.acceptanceLevel?this.orientation="left-right":this.angle>PI/4-this.acceptanceLevel&&this.angle<PI/4+this.acceptanceLevel?this.orientation="top/left-bottom/right":this.angle>PI/2-this.acceptanceLevel&&this.angle<PI/2+this.acceptanceLevel?this.orientation="top-bottom":this.angle<-(PI/4-this.acceptanceLevel)&&this.angle>-(PI/4+this.acceptanceLevel)?this.orientation="left/bottom-top/right":(MODE>1&&console.warn("some noise with this.angle: "+this.angle),this.orientation="unkown")}get_status(){this.orthoProjectionPoint=orthogonalProjection1(this.end,this.endOrtho,this.pos),this.pos.dist(this.orthoProjectionPoint)<=this.OkLevel&&(this.alive=!1,this.acc=createVector(0,0,0),this.vel=createVector(0,0,0)),this.pos.dist(this.checkpointA)<=2&&(this.passedA=!0),this.pos.dist(this.checkpointB)<=2&&(this.passedB=!0)}savePath(){if(this.brushSize=this.radius,this.elements=[],"Line"==this.brushShape)for(var t=0;t<this.elementCount;t++)this.elements.push({shape:"Line",posX:this.pos.x+getP5RandomFromInterval(-this.brushSize,this.brushSize),posY:this.pos.y+getP5RandomFromInterval(-this.brushSize,this.brushSize),posBX:this.pos.x+getP5RandomFromInterval(-this.brushSize,this.brushSize),posBY:this.pos.y+getP5RandomFromInterval(-this.brushSize,this.brushSize)});else if("Ellipse"==this.brushShape)for(t=0;t<this.elementCount;t++)this.elements.push({shape:"Ellipse",posX:this.pos.x+getP5RandomFromInterval(-this.brushSize,this.brushSize),posY:this.pos.y+getP5RandomFromInterval(-this.brushSize,this.brushSize),width:getP5RandomFromInterval(0,this.brushSize/2),height:getP5RandomFromInterval(0,this.brushSize/2)});else if("Triangle"==this.brushShape)for(t=0;t<this.elementCount;t++)this.elements.push({shape:"Triangle",posX:this.pos.x+getP5RandomFromInterval(-this.brushSize,this.brushSize),posY:this.pos.y+getP5RandomFromInterval(-this.brushSize,this.brushSize),posBX:this.pos.x+getP5RandomFromInterval(-this.brushSize,this.brushSize),posBY:this.pos.y+getP5RandomFromInterval(-this.brushSize,this.brushSize),posCX:this.pos.x+getP5RandomFromInterval(-this.brushSize,this.brushSize),posCY:this.pos.y+getP5RandomFromInterval(-this.brushSize,this.brushSize)});else console.warn("No brush shape specified, oida!")}update(){this.alive&&(this.get_status(),0==this.passedA?this.acc=this.accBoost:1==this.passedA&&0==this.passedB?this.acc=createVector(0,0,0):1==this.passedA&&1==this.passedB?this.acc=this.sloBoost:this.alive,this.vel.add(this.acc),this.pos.add(this.vel),this.acc.x<0||this.acc.x<0||this.acc.x,this.vel.x>0?this.radius=Math.round(100*map(this.vel.x,BRUSHFULLSPEEDMIN,BRUSHFULLSPEEDMAX,this.radiusMax,this.radiusMin))/100:this.vel.y>0&&(this.radius=Math.round(100*map(this.vel.y,BRUSHFULLSPEEDMIN,BRUSHFULLSPEEDMAX,this.radiusMax,this.radiusMin))/100),this.savePath(),pointInPolygon(sunny.coordsList,[this.pos.x,this.pos.y])?this.strokeColorTemp=highlightColor(this.strokeColor,80):this.strokeColorTemp=this.strokeColor)}show(){MODE>=5&&(push(),translate(-width/2,-height/2),drawArrow(this.end,this.endOrtho,"orange"),translate(this.orthoProjectionPoint.x,this.orthoProjectionPoint.y),pop(),push(),translate(-width/2,-height/2),translate(this.start),noStroke(),fill("blue"),ellipse(0,0,10),pop(),push(),translate(-width/2,-height/2),translate(this.checkpointA),noStroke(),fill("red"),ellipse(0,0,5),stroke(5),pop(),push(),translate(-width/2,-height/2),translate(this.checkpointB),noStroke(),fill("red"),ellipse(0,0,5),pop(),push(),translate(-width/2,-height/2),translate(this.end),noStroke(),fill("purple"),ellipse(0,0,10),pop()),MODE>=5?(push(),translate(-width/2,-height/2),translate(this.pos),noStroke(),fill("black"),ellipse(0,0,3*this.radius,3*this.radius),pop()):this.drawBrush()}drawBrush(){if(this.alive)for(var t=0;t<this.elements.length;t++)paintBroBuffer.push(),paintBroBuffer.strokeWeight(this.strokeSize),paintBroBuffer.stroke(distortColorNew(this.strokeColorTemp,this.strokeColorDistort,!1)),paintBroBuffer.fill(this.strokeColorTemp),"Line"==this.brushShape?paintBroBuffer.line(this.elements[t].posX,this.elements[t].posY,this.elements[t].posBX,this.elements[t].posBY):"Ellipse"==this.brushShape?paintBroBuffer.ellipse(this.elements[t].posX,this.elements[t].posY,this.elements[t].width,this.elements[t].height):"Triangle"==this.brushShape?paintBroBuffer.triangle(this.elements[t].posX,this.elements[t].posY,this.elements[t].posBX,this.elements[t].posBY,this.elements[t].posCX,this.elements[t].posCY):console.warn("No brush shape specified, oida!"),paintBroBuffer.pop()}}class BrushSystem{constructor(){this.brushes=[]}add(t){this.brushes.push(t)}show(){for(var t of this.brushes)t.update(),t.show()}check_all_complete(t){if(0==this.all_lines_complete||this.brushes.length>0){for(var s of(this.brushes_alive_status=[],this.brushes))s.category==t&&this.brushes_alive_status.push(s.alive);return this.brushes_alive_status.every((t=>!1===t))}return!1}}